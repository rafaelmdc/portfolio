{% load static %}
{% load wagtailcore_tags %}

<!DOCTYPE html>
<html lang="en" data-bs-theme="{{ theme|default:'dark' }}">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>{% block title %}RDC{% endblock %}</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <meta name="color-scheme" content="dark light">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b0e12">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">

  <style>
    /* 1) Minimal dark palette so first paint isn't white */
    :root[data-bs-theme="dark"]{
      --bs-body-bg:#0b0e12; 
      --bs-body-color:#e6e6e6;
    }
    html, body{
      background-color:var(--bs-body-bg);
      color:var(--bs-body-color);
    }

    /* 2) Kill common white flashes even without main.css */
    #preloader{ background:#0b0e12 !important; }          /* or display:none to test */
    .header.light-background{ background:transparent !important; }

    /* Optional: no transitions during first paint */
    html.preload *, html.preload *::before, html.preload *::after{ transition:none !important; }
    html, body { height: 100%; }

    body{
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .main{
      flex: 1 0 auto;           /* main grows to fill leftover space */
      display: flex;
      flex-direction: column;
    }

    /* Footer stays after main, not floating up */
    .footer{
      margin-top: auto;
    }
  </style>
  <script>
    // SSR should set this, but as a fallback pick system preference immediately
    (function(){
      var saved = document.cookie.match(/(?:^|; )theme=(dark|light)/)?.[1];
      var theme = saved || (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.setAttribute('data-bs-theme', theme);
      document.documentElement.classList.add('preload');
      window.addEventListener('load', function(){ document.documentElement.classList.remove('preload'); }, {once:true});
    })();
  </script>

  <!-- Favicons -->
  <link href="{% static 'assets/img/favicon.png' %}" rel="icon">
  <link href="{% static 'assets/img/apple-touch-icon.png' %}" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&family=Poppins:wght@100;200;300;400;500;600;700;800;900&family=Raleway:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/aos/aos.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">

  <script src="{% static 'assets/vendor/typed.js/typed.umd.js' %}"></script>
  <!-- Main CSS File -->
  <link href="{% static 'assets/css/main.css' %}" rel="stylesheet">

  {% block head_extra %}{% endblock %}
  {% block extra_css %}{% endblock %}
</head>


<body class="{% block body_class %}{% endblock %}">

  <!-- ======= Header / Navbar ======= -->
    <header id="header" class="header d-flex align-items-center light-background sticky-top" style="--header-height: 80px;">
    <div class="container position-relative d-flex align-items-center justify-content-between">

      <nav id="navmenu" class="navmenu">
        <ul>

          <!-- Home (Django view) -->
          <li>
            <a href="{% url 'home' %}"
              class="{% if request.resolver_match.url_name == 'home' %}active{% endif %}">
              Home
            </a>
          </li>

          <!-- About (Django view) -->
          <li>
            <a href="{% url 'about' %}"
              class="{% if request.resolver_match.url_name == 'about' %}active{% endif %}">
              About
            </a>
          </li>

          <!-- Resume (Django view) -->
          <li>
            <a href="{% url 'resume' %}"
              class="{% if request.resolver_match.url_name == 'resume' %}active{% endif %}">
              Resume
            </a>
          </li>

          <!-- Portfolio (Wagtail page) -->
          <li>
            <a href="/portfolio/"
              class="{% if request.path|slice:':10' == '/portfolio' %}active{% endif %}">
              Portfolio
            </a>
          </li>

          <!-- Blog (Wagtail page) -->
          <li>
            <a href="/blog/"
              class="{% if request.path|slice:':6' == '/blog/' %}active{% endif %}">
              Blog
            </a>
          </li>

          <!-- Contact (Django view) -->
          <li>
            <a href="{% url 'contact' %}"
              class="{% if request.resolver_match.url_name == 'contact' %}active{% endif %}">
              Contact
            </a>
          </li>

        </ul>
      </nav>

      <!-- Mobile nav toggle moved outside the <nav> to avoid it being clipped/hidden by the overlay -->
      <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      
    </div>
  </header>


  <!-- ======= Main Content ======= -->
  <main class="main">
    {% block content %}
    {% endblock %}
  </main>

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="container">
      <div class="social-links d-flex justify-content-center gap-3">
        <a href="https://github.com/rafaelmdc" target="_blank" rel="noopener" aria-label="GitHub">
          <i class="bi bi-github"></i>
        </a>
        <a href="https://www.linkedin.com/in/rafael-alexandre-correia-2b8a33213/" target="_blank" rel="noopener" aria-label="LinkedIn">
          <i class="bi bi-linkedin"></i>
        </a>
        <a href="mailto:rafaelmdcorreia@gmail.com" aria-label="Email">
          <i class="bi bi-envelope"></i>
        </a>
      </div>

      <div class="text-center small text-body-secondary mt-3">
        © {% now "Y" %} Rafael Correia · Built with Django + Wagtail
      </div>
    </div>
    <div class="text-center small text-body-secondary mt-2">
      Always happy to talk about research, code, or collaboration!
    </div>
  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center">
    <i class="bi bi-arrow-up-short"></i>
  </a>

  
  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'assets/vendor/php-email-form/validate.js' %}"></script>
  <script src="{% static 'assets/vendor/aos/aos.js' %}"></script>
  <script src="{% static 'assets/vendor/typed.js/typed.umd.js' %}"></script>
  <script src="{% static 'assets/vendor/waypoints/noframework.waypoints.js' %}"></script>
  <script src="{% static 'assets/vendor/purecounter/purecounter_vanilla.js' %}"></script>
  <script src="{% static 'assets/vendor/swiper/swiper-bundle.min.js' %}"></script>
  <script src="{% static 'assets/vendor/imagesloaded/imagesloaded.pkgd.min.js' %}"></script>
  <script src="{% static 'assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
  <script src="{% static 'assets/vendor/glightbox/js/glightbox.min.js' %}"></script>

  <!-- Main JS File -->
  <script src="{% static 'assets/js/main.js' %}"></script>

  {% block scripts_extra %}{% endblock %}
  {% block extra_js %}{% endblock %}
</body>
</html>
