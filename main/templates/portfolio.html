{# templates/portfolio.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}{{ page.title|default:"Portfolio" }} â€“ FolioOne{% endblock %}
{% block body_class %}portfolio-page{% endblock %}

{% block content %}
<section id="portfolio" class="portfolio section">
  <div class="container section-title" data-aos="fade-up">
    <h2>{{ page.title|default:"Portfolio" }}</h2>
    {% if page and page.lead %}<p>{{ page.lead }}</p>{% endif %}
  </div>

  <div class="container" data-aos="fade-up" data-aos-delay="100">
    <div class="isotope-layout" data-default-filter="*" data-layout="masonry" data-sort="original-order">

      <ul class="portfolio-filters isotope-filters" data-aos="fade-up" data-aos-delay="200">
        <li data-filter="*" class="filter-active">All</li>
        {% for cat in categories %}
          <li data-filter=".filter-{{ cat.slug }}">{{ cat.name }}</li>
        {% endfor %}
      </ul>

      <div class="row gy-4 isotope-container" data-aos="fade-up" data-aos-delay="300">
        {% for item in items %}
          <div class="col-lg-4 col-md-6 portfolio-item isotope-item{% for c in item.categories.all %} filter-{{ c.slug }}{% endfor %}">
            {# Make entire card clickable with a stretched-link #}
            <div class="portfolio-card position-relative">
              <a href="{% url 'portfolio_detail' item.slug %}" class="stretched-link" aria-label="Open {{ item.title }}"></a>

              <div class="portfolio-img">
                <img src="{{ item.image.url }}" alt="{{ item.title }}" class="img-fluid">
                <div class="portfolio-overlay">
                  <a href="{{ item.lightbox_url }}" class="glightbox portfolio-lightbox" aria-label="Zoom {{ item.title }}"><i class="bi bi-plus"></i></a>
                  {% if item.external_url %}
                    <a href="{{ item.external_url }}" class="portfolio-details-link" target="_blank" rel="noopener" aria-label="Open external link for {{ item.title }}"><i class="bi bi-link"></i></a>
                  {% endif %}
                </div>
              </div>

              <div class="portfolio-info">
                <h4>{{ item.title }}</h4>
                {% if item.subtitle %}<p>{{ item.subtitle }}</p>{% endif %}
                {% if item.categories.all %}
                  <div class="portfolio-tags">
                    {% for c in item.categories.all %}
                      <span>{{ c.name }}</span>
                    {% endfor %}
                  </div>
                {% endif %}
              </div>
            </div>
          </div>
        {% empty %}
          <p class="text-muted">No portfolio items yet.</p>
        {% endfor %}
      </div>

    </div>
  </div>
</section>
{% endblock content %}
